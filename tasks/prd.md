모각코어 (Mogak-Core) 서비스 최종 PRD (v2.0)
1. 문서 개요 (Overview)
프로젝트명: 모각코어 (MogakCore)
핵심 목표: 커뮤니티 멤버들이 지정된 '코어 타임'의 참여 현황을 실시간으로 확인하게 하여, 함께 코딩하는 분위기를 조성하고 자발적인 모각코 참여를 유도한다.
버전: v2.0 (기술 스택 및 아키텍처 확정)
최종 업데이트: 2025년 8월 19일

2. 배경 및 문제 정의 (Background & Problem)

커뮤니티 내 '모여서 각자 코딩(모각코)'에 대한 높은 수요에도 불구하고, 참여자들의 유동적인 스케줄과 "혼자일지도 모른다"는 심리적 장벽으로 인해 활성화가 어려웠습니다. 본 프로젝트는 이 문제를 해결하기 위해 특정 시간대에 참여 인원을 시각적으로 보여줌으로써 참여의 허들을 낮추는 것을 목표로 합니다.

3. 목표 (Goals)

Primary Goal: 사용자가 로그인 없이, 오늘의 코어 타임별 참여 예정 인원을 한눈에 파악하게 한다.

Secondary Goals:

3클릭 이내의 직관적인 참여/취소 플로우를 제공한다.

참여 현황이 실시간으로 업데이트되는 시각적 경험을 제공하여 참여를 독려한다.

완전 익명 기반으로 운영하여 심리적 부담을 최소화한다.

4. 핵심 기능 명세 (Feature Specifications)
4.1. 메인 화면 (UI)
페이지 구성: "오늘의 모각코 현황" 헤더와 4개의 코어 타임 섹션이 카드 형태로 표시되는 단일 페이지로 구성.
코어 타임 (하드코딩): 오전 10시, 오후 3시, 저녁 8시, 밤 10시.
코어 타임 카드 구성 요소:
시간 정보: "오늘 저녁 8시"
참여 인원 수: "현재 N명 참여 중" (실시간 업데이트)
시각화: 참여 인원 수에 비례하여 채워지는 바(Bar) 또는 쌓이는 블록(Block) 그래픽.
버튼: "참여하기" / "참여 취소"
4.2. 참여 기능 (Participation Flow)
최초 접속 시, 클라이언트(브라우저)는 **익명 식별자(browserId)**를 생성하여 로컬 스토리지에 저장한다.
사용자가 "참여하기" 버튼을 클릭한다.
모달(Modal) 창에 "취소 시 사용할 비밀번호(4자리 숫자)" 입력 필드를 표시한다.
"확인" 버튼 클릭 시, 서버로 coreTime, browserId, password를 전송한다.
서버는 해당 browserId의 참여 여부를 확인 후, 데이터를 저장하고 현재 참여 인원 수를 반환한다.
클라이언트는 참여 정보를 로컬 스토리지에 기록하고, 버튼을 "참여 취소"로 변경하며 화면을 즉시 갱신한다.
4.3. 참여 취소 기능 (Cancellation Flow)
사용자가 "참여 취소" 버튼을 클릭한다.
모달 창에서 비밀번호 입력을 받는다.
서버로 coreTime, browserId, password를 전송한다.
서버는 저장된 비밀번호와 일치하는지 검증 후, 데이터를 삭제하고 현재 참여 인원 수를 반환한다.
클라이언트는 로컬 스토리지의 참여 정보를 삭제하고, 버튼을 "참여하기"로 변경하며 화면을 갱신한다.
4.4. 정책 및 예외 처리
비밀번호 분실: 복구 기능은 지원하지 않는다. (UX 카피로 명확히 안내)
중복 참여 방지: browserId를 기준으로 각 코어 타임에 한 번만 참여할 수 있다.
5. 기술 스택 및 데이터 구조 (Tech Stack & Data Structure)
Front-end: React(Next.js) 권장
Deployment: Vercel
Data Storage: MongoDB Atlas
Vercel Serverless Function을 통해 MongoDB Atlas에 연결하여 데이터를 처리한다.
데이터베이스 스키마:
participations 라는 이름의 단일 컬렉션을 사용한다.
각 참여 건은 하나의 도큐먼트(Document)로 저장된다.
participations 컬렉션의 도큐먼트 구조 예시:
code
JavaScript
{
  "_id": ObjectId("..."), // MongoDB 자동 생성 ID
  "date": "2025-08-20",    // 참여 날짜 (YYYY-MM-DD 형식)
  "coreTime": "2200",         // 코어 타임 (HHMM 형식)
  "browserId": "a1b2c3d4-e5f6-...", // 로컬 스토리지에 저장된 UUID
  "passwordHash": "$2a$10$...",   // bcrypt로 해시된 비밀번호
  "createdAt": ISODate("...") // 생성 시각 (TTL 인덱스 설정용)
}
비밀번호 처리: 사용자가 입력한 비밀번호는 bcryptjs 라이브러리를 사용해 해시(Hash)하여 저장한다. 평문 저장은 지양한다.
6. API 엔드포인트 설계
GET /api/status?date=YYYY-MM-DD:
지정된 날짜의 모든 코어 타임별 참여 인원 수를 조회한다. (클라이언트에서 3~5초 주기로 폴링)
POST /api/participate:
Body: { date, time, browserId, password }
참여 신청을 처리한다. 성공 시 현재 참여 인원 수를 반환한다.
POST /api/cancel:
Body: { date, time, browserId, password }
참여 취소를 처리한다. 성공 시 현재 참여 인원 수를 반환한다.
GET /api/reset (Cron Job 호출용):
오래된 데이터를 삭제하는 등의 정리 작업을 수행한다.
7. 비기능적 요구사항 (Non-Functional Requirements)
데이터 초기화/정리:
전략: 날짜별로 데이터를 조회하므로 자정에 즉시 리셋할 필요는 없다.
구현: MongoDB의 TTL(Time-To-Live) 인덱스를 createdAt 필드에 설정하여, 생성 후 24시간이 지난 데이터가 자동으로 삭제되게 하는 것을 권장한다. 또는 Vercel Cron으로 매일 한 번씩 /api/reset을 호출하여 전날 데이터를 삭제하는 배치 작업을 수행한다.
성능: 모든 API 요청은 1초 이내에 응답해야 한다.
실시간성: 클라이언트는 3~5초 주기의 폴링(Polling) 방식으로 GET /api/status를 호출하여 참여 현황을 갱신한다. (초기 버전에서는 WebSocket/SSE보다 구현이 간단하고 안정적)
어뷰징 방지: 악의적인 요청을 막기 위해 @upstash/ratelimit 라이브러리를 사용하여 API 엔드포인트에 IP 기반의 Rate Limiting(예: 10초당 10회)을 적용한다.


7. 개발 범위에서 제외되는 항목 (Out of Scope)

사용자 로그인 및 회원가입 기능

비밀번호 찾기/복구 기능

관리자 페이지 (코어 타임 동적 관리 기능 등)

오프라인 공간(라운지) 예약 및 연동 기능

누가 참여하는지 보여주는 기능 (완전 익명 유지)